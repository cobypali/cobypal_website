<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Adventures | Coby Palivathukal</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0B1220;
            color: #E6EDF7;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            overflow-x: hidden;
        }
        a { color: inherit; text-decoration: none; }
        nav {
            position: fixed; top: 0; left: 0; right: 0; z-index: 100;
            background: rgba(11, 18, 32, 0.95); backdrop-filter: blur(10px);
            padding: 20px 50px; display: flex; justify-content: space-between; align-items: center;
            border-bottom: 1px solid #1A2438;
        }
        .logo { font-size: 24px; font-weight: 700; color: #E6EDF7; letter-spacing: 2px; }
        .nav-links { display: flex; gap: 40px; }
        .nav-links a { font-size: 14px; font-weight: 400; letter-spacing: 1px; text-transform: uppercase; transition: color 0.3s; }
        .nav-links a:hover, .nav-links a.active { color: #3B82F6; }
        main { flex: 1; padding: 100px 50px 40px; }
        .content-section { max-width: 1400px; width: 100%; margin: 0 auto; }
        .page-title { font-size: 48px; font-weight: 600; text-align: center; margin-bottom: 16px; }
        .page-subtitle { text-align: center; color: rgba(230,237,247,0.6); font-size: 16px; margin-bottom: 32px; }
        .channel-link { text-align: center; margin-bottom: 24px; }
        .channel-link a {
            display: inline-flex; align-items: center; gap: 12px;
            background: linear-gradient(135deg, #FF0000, #CC0000); color: white;
            padding: 14px 28px; border-radius: 50px; font-size: 16px; font-weight: 600;
            transition: all 0.3s; box-shadow: 0 4px 15px rgba(255,0,0,0.3);
        }
        .channel-link a:hover { transform: translateY(-3px); box-shadow: 0 8px 25px rgba(255,0,0,0.4); }
        .channel-link svg { width: 24px; height: 24px; }
        .globe-hint {
            text-align: center; color: rgba(230,237,247,0.4); font-size: 13px;
            margin-top: 12px; letter-spacing: 0.5px;
        }
        .globe-wrapper {
            position: relative; width: 100%; height: 70vh; min-height: 500px;
            border-radius: 16px; overflow: hidden;
            background: radial-gradient(ellipse at center, #0d1a2d 0%, #0B1220 70%);
        }
        #globe-container { width: 100%; height: 100%; cursor: grab; }
        #globe-container:active { cursor: grabbing; }
        #city-tooltip {
            position: absolute; pointer-events: none; padding: 6px 14px;
            background: rgba(11,18,32,0.9); border: 1px solid rgba(255,68,68,0.5);
            border-radius: 8px; font-size: 13px; font-weight: 500; color: #E6EDF7;
            white-space: nowrap; display: none; z-index: 10;
            backdrop-filter: blur(8px); transform: translate(-50%, -130%);
        }
        #city-tooltip .video-count { color: rgba(230,237,247,0.5); font-size: 11px; margin-left: 6px; }
        /* Video Panel */
        #video-panel {
            position: fixed; top: 0; right: 0; width: 420px; height: 100vh;
            background: rgba(11,18,32,0.98); backdrop-filter: blur(20px);
            border-left: 1px solid #1A2438; z-index: 250;
            transform: translateX(100%); transition: transform 0.35s ease;
            display: flex; flex-direction: column;
        }
        #video-panel.active { transform: translateX(0); }
        .panel-header {
            display: flex; justify-content: space-between; align-items: center;
            padding: 24px; border-bottom: 1px solid #1A2438; flex-shrink: 0;
        }
        .panel-header h2 { font-size: 22px; font-weight: 600; }
        .panel-header .city-count { font-size: 13px; color: rgba(230,237,247,0.5); margin-top: 4px; }
        #panel-close {
            background: rgba(255,255,255,0.08); border: none; color: #E6EDF7;
            width: 36px; height: 36px; border-radius: 50%; cursor: pointer;
            font-size: 20px; display: flex; align-items: center; justify-content: center;
            transition: background 0.2s;
        }
        #panel-close:hover { background: rgba(255,68,68,0.3); }
        #panel-video-list { flex: 1; overflow-y: auto; padding: 16px; }
        .video-item {
            display: flex; gap: 12px; padding: 12px; border-radius: 12px;
            transition: background 0.2s; cursor: pointer; margin-bottom: 8px;
        }
        .video-item:hover { background: rgba(255,255,255,0.05); }
        .video-thumb {
            width: 140px; min-width: 140px; aspect-ratio: 16/9;
            border-radius: 8px; overflow: hidden; position: relative;
        }
        .video-thumb img { width: 100%; height: 100%; object-fit: cover; }
        .video-thumb .play-icon {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%,-50%);
            width: 32px; height: 32px; background: rgba(255,0,0,0.85); border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            opacity: 0; transition: opacity 0.2s;
        }
        .video-item:hover .play-icon { opacity: 1; }
        .play-icon svg { width: 14px; height: 14px; fill: white; margin-left: 2px; }
        .video-item-info { display: flex; flex-direction: column; justify-content: center; }
        .video-item-title { font-size: 13px; font-weight: 500; line-height: 1.4; color: #E6EDF7; }
        /* Video Modal */
        .video-modal {
            position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.95); z-index: 300; display: none;
            align-items: center; justify-content: center; padding: 40px;
        }
        .video-modal.active { display: flex; }
        .video-modal-content { width: 100%; max-width: 1000px; aspect-ratio: 16/9; position: relative; }
        .video-modal iframe { width: 100%; height: 100%; border: none; border-radius: 12px; }
        .video-modal-close {
            position: absolute; top: -50px; right: 0;
            background: rgba(255,255,255,0.1); border: none; color: white;
            width: 40px; height: 40px; border-radius: 50%; cursor: pointer;
            font-size: 24px; display: flex; align-items: center; justify-content: center;
        }
        .video-modal-close:hover { background: rgba(255,0,0,0.5); }
        /* Panel overlay for mobile */
        #panel-overlay {
            position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.5); z-index: 240; display: none;
        }
        #panel-overlay.active { display: block; }
        /* Footer */
        footer { padding: 20px 50px 40px; text-align: center; border-top: 1px solid #1A2438; }
        .social-links-3d { display: flex; justify-content: center; gap: 30px; margin-bottom: 20px; flex-wrap: wrap; }
        .social-icon-container { width: 100px; height: 100px; cursor: pointer; transition: transform 0.3s; }
        .social-icon-container:hover { transform: scale(1.15); }
        .social-icon-container canvas { width: 100%; height: 100%; }
        .copyright { font-size: 12px; color: rgba(230,237,247,0.5); }
        /* Brain Regions Sidebar */
        #brain-regions-nav {
            position: fixed; top: 80px; right: 20px; background: #121A2B;
            backdrop-filter: blur(20px); padding: 20px; border-radius: 16px;
            color: #E6EDF7; border: 1px solid #1A2438;
            box-shadow: 0 8px 32px rgba(0,0,0,0.4); z-index: 50;
        }
        #brain-regions-nav h3 { margin-bottom: 12px; font-size: 14px; text-transform: uppercase; letter-spacing: 1px; color: rgba(230,237,247,0.5); }
        #brain-regions-nav ul { list-style: none; }
        #brain-regions-nav li a {
            padding: 8px 12px; border-radius: 8px; transition: background 0.2s;
            font-size: 14px; display: flex; align-items: center; gap: 10px;
        }
        #brain-regions-nav li a:hover { background: rgba(59,130,246,0.2); }
        #brain-regions-nav li a.active { background: rgba(59,130,246,0.3); }
        #brain-regions-nav .dot { width: 10px; height: 10px; border-radius: 50%; flex-shrink: 0; }
        #brain-regions-nav .back-to-brain {
            display: block; text-align: center; background: #3B82F6; color: white;
            padding: 10px 16px; border-radius: 8px; font-size: 13px; font-weight: 600;
            margin-top: 14px; transition: background 0.2s, transform 0.2s;
        }
        #brain-regions-nav .back-to-brain:hover { background: #2563EB; transform: translateY(-1px); }
        @media (max-width: 768px) {
            nav { padding: 15px 20px; }
            .logo { font-size: 20px; }
            .nav-links { gap: 20px; margin-left: 30px; }
            .nav-links a { font-size: 12px; }
            main { padding: 100px 15px 30px; }
            .page-title { font-size: 32px; }
            .globe-wrapper { height: 50vh; min-height: 350px; }
            #video-panel { width: 100%; }
            footer { padding: 20px; }
            .social-links-3d { gap: 20px; margin-left: -25px; }
            .social-icon-container { width: 70px; height: 70px; }
            #brain-regions-nav { display: none; }
        }
    </style>
</head>
<body>
    <nav>
        <a href="index.html" class="logo">COBYPAL</a>
        <div class="nav-links">
            <a href="about.html">About</a>
            <a href="kippystudios.html">Kippy Studios</a>
            <a href="brain.html">Coby's Brain</a>
        </div>
    </nav>
    <div id="brain-regions-nav">
        <h3>Brain Regions</h3>
        <ul>
            <li><a href="adventures.html" class="active"><span class="dot" style="background:#44aaff"></span>Adventures</a></li>
            <li><a href="reading.html"><span class="dot" style="background:#44ff44"></span>Books</a></li>
            <li><a href="filmtv.html"><span class="dot" style="background:#ff4444"></span>Film and TV</a></li>
            <li><a href="food.html"><span class="dot" style="background:#ff8844"></span>Food</a></li>
            <li><a href="games.html"><span class="dot" style="background:#ffaa00"></span>Games and Interactive Media</a></li>
            <li><a href="music.html"><span class="dot" style="background:#ff44ff"></span>Music</a></li>
            <li><a href="principles.html"><span class="dot" style="background:#aa00ff"></span>Principles</a></li>
            <li><a href="protocols.html"><span class="dot" style="background:#00ffaa"></span>Protocols</a></li>
            <li><a href="thoughts.html"><span class="dot" style="background:#00d4ff"></span>Thoughts</a></li>
        </ul>
        <a href="brain.html" class="back-to-brain">Back to Coby's Brain</a>
    </div>
    <main>
        <div class="content-section">
            <h1 class="page-title">Coby's Adventures</h1>
            <p class="page-subtitle">Exploring the world one adventure at a time</p>
            <div class="channel-link">
                <a href="https://www.youtube.com/channel/UCuGQRO3yHpaNdtCoWwkRocA" target="_blank">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/>
                    </svg>
                    Subscribe on YouTube
                </a>
            </div>
            <div class="globe-wrapper">
                <div id="globe-container"></div>
                <div id="city-tooltip"></div>
            </div>
            <p class="globe-hint">Drag to rotate &middot; Scroll to zoom &middot; Click a pin to explore videos</p>
        </div>
    </main>
    <div id="panel-overlay"></div>
    <div id="video-panel">
        <div class="panel-header">
            <div>
                <h2 id="panel-city-name"></h2>
                <div class="city-count" id="panel-city-count"></div>
            </div>
            <button id="panel-close">&times;</button>
        </div>
        <div id="panel-video-list"></div>
    </div>
    <div class="video-modal" id="video-modal">
        <div class="video-modal-content">
            <button class="video-modal-close" id="modal-close">&times;</button>
            <iframe id="video-iframe" src="" allowfullscreen allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"></iframe>
        </div>
    </div>
    <footer>
        <div class="social-links-3d" id="social-links-3d">
            <div class="social-icon-container" data-link="https://www.youtube.com/user/cobypalivathukal" data-model="socials/youtube_icon/scene.gltf" title="YouTube"></div>
            <div class="social-icon-container" data-link="https://www.instagram.com/cobypal" data-model="socials/instagram_icon/scene.gltf" title="Instagram"></div>
            <div class="social-icon-container" data-link="https://www.tiktok.com/@cobypal?lang=en" data-model="socials/tiktok_icon/scene.gltf" title="TikTok"></div>
            <div class="social-icon-container" data-link="https://www.twitter.com/cobypal" data-model="socials/x_icon/scene.gltf" title="X"></div>
            <div class="social-icon-container" data-link="http://threads.net/@cobypal" data-model="socials/threads_icon/scene.gltf" title="Threads"></div>
            <div class="social-icon-container" data-link="https://www.linkedin.com/in/cobypalivathukal/" data-model="socials/linkedin_icon/scene.gltf" title="LinkedIn"></div>
            <div class="social-icon-container" data-link="https://www.facebook.com/coby.palivathukal" data-model="socials/facebook_icon/scene.gltf" title="Facebook"></div>
        </div>
        <p class="copyright">&copy; 2026 Coby Palivathukal. All rights reserved.</p>
    </footer>
    <script type="importmap">
    {
        "imports": {
            "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
            "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
        }
    }
    </script>
    <script type="module">
import * as THREE from 'three';
import { OrbitControls } from 'three/addons/controls/OrbitControls.js';
import { GLTFLoader } from 'three/addons/loaders/GLTFLoader.js';

// ── City + Video Data ──────────────────────────────────────────────
const CITIES = {
"Oakland":{lat:37.80,lng:-122.27,v:[
["Travis Scott - Sicko Mode (360 Video) (Live at Rolling Loud 2018)","1DEFftIjXDU"],
["Travis Scott - Goosebumps (360 Video) (Live at Rolling Loud 2018)","FGaSJs4pZBw"],
["Travis Scott - Stargazing (360 Video) (Live at Rolling Loud 2018)","A2Xz1zJj3X8"],
["Sheck Wes - Mo Bamba w Travis Scott (360 Video) (Live at Rolling Loud 2018)","JHkai_fTEko"],
["Travis Scott - Butterfly Effect (360 Video) (Live at Rolling Loud 2018)","rNc-fmp5oPc"],
["Travis Scott and Gunna - Yosemite (360 Video) (Live at Rolling Loud 2018)","FXz0UFY8sBY"],
["Travis Scott and Young Thug - Pick up the Phone (360 Video) (Live at Rolling Loud 2018)","B8cZ_ADD-Ow"],
["Travis Scott & Don Toliver - Can't Say (360 Video) (Live at Rolling Loud 2018)","P5WMU1EHpSw"]]},
"New York City":{lat:40.71,lng:-74.01,v:[
["Ordering a Pastrami Sandwich from Katz's Deli in NYC (360 Video)","h-iEo31Zg84"],
["Top of the World Trade Center (360 Video)","D7j0_cwC4bo"],
["Times Square NYC (360 Video)","8oLVvB-c3TI"],
["Approaching the World Trade Center (360 Video)","OEgRmwrhTWc"],
["Going to the Top of the World Trade Center NYC (360 Video)","O4VOeEOMrGI"],
["Manhattan Bridge NYC (360 Video)","Y1R1SBSl0mU"],
["Coby in NYC 2023 (360 Video)","ytPooPqclsY"],
["West Village Tour in NYC (360 Video)","nwBJdzJxgz4"]]},
"South Lake Tahoe":{lat:38.93,lng:-119.98,v:[
["VR Water Skiing (360 Video)","kAUkQ4O4g2k"],
["VR Cliff Jumping at Fallen Leaf Lake (360 Video)","TZqEns89UkU"],
["Baby Beach at Stanford Sierra Camp (360 Video)","2TD0OC5D1hM"],
["Paddleboarding at Fallen Leaf Lake (360 Video)","R5dDbNKpWJc"],
["Sky Express at Heavenly (Mounted) (360 Video)","P1IFF6HWjvw"],
["Roque Takes an L","ZUZsBTqKvfM"],
["Sky Express at Heavenly (Handheld) (360 Video)","WH96J7hUHSA"],
["Day 1 at Heavenly (360 Video)","_ZEvAmEkgDQ"],
["Gondola Ride at Heavenly (360 Video)","IstCxJcqVb8"],
["Jacuzziing at Heavenly (360 Video)","lKAn4GObVZU"],
["Roque Takes an L at Heavenly (360 Video)","AiWHWpinvLc"],
["Angora Lake (360 Video)","Od6i_UyCZLA"],
["Pyramid Peak Summit (360 Video)","S0D8hAo7iyo"]]},
"Venice Beach":{lat:33.985,lng:-118.47,v:[
["Volleyball Game at Venice Beach (360 Video)","HqQvmpBSfGk"],
["Sarah's August 2021 Box Party (360 video)","msYfpMe-VVE"],
["LED Wall Shoot Time Lapse (360 Video)","WsezqckPdiw"],
["Cute Pug in Venice Beach (360 Video)","DKF4D8vUF7I"],
["Caleb's Mocap Performance (1/28/21) (360 Video)","6A_ADNJFU0Q"],
["Mocap Shoot (12/2/2020) (360 Video)","IztgWFu5H_k"],
["Real Time Compositing Test @Elektrashock (360 Video)","UHqdQAewoMk"],
["Venice Beach Volleyball (360 Video)","lEHukPkhfa8"],
["665 Rose Ave","uC3Lzx22Y3s"],
["Mocap Shoot (1/17/2021) (360 Video)","BQl7HjpUGn4"]]},
"Los Angeles":{lat:34.05,lng:-118.24,v:[
["Shrine Auditorium Interior (360 Video)","YBbLh87qLXE"],
["David Geffen Theater at the Academy Museum in LA, CA (360 Video)","lI1TLih3_NY"],
["Bike Ride in Skid Row, Los Angeles (360 Video)","K2JD8S134xQ"],
["Kobe Bryant Memorial Murals in DTLA (360 Video)","jIQhqJQOMQ0"],
["UCLA (360 Video)","2a2k6ookkWw"],
["Matt Reeves Speech at USC School of Cinematic Arts Graduation 2022 (360 Video)","NiaOzgBncxU"],
["Elektrashock LED Wall Test Shoot","DrZaMIQ2lRk"],
["Walt Disney Concert Hall in DTLA (360 video)","qiSIJymgz_I"],
["LAX Terminal 1 (360 Video)","QZp8Qth_Abc"],
["LED Wall Test (360 Video)","SVjpmD44GrQ"],
["Hollywood Sign Hike (360 Video)","l2qZhxihB2g"],
["Vignesh's Motion Capture Shoot (360 video)","Rvhmp9ba0-8"],
["Brenda's VJ Set Epic Moments (360 Video)","2_z2yBRo8EA"],
["Tommy Trojan Statue at USC (360 Video)","7T6etHGPBRo"],
["The Lab 2.0 (360 Video)","rNzayXhsw1A"],
["LED Wall Test Shoot (Timelapse) (4k)","4BcdWL1qFc4"],
["USC Graduation 2022 (360 Video)","ou9OQr5Twdw"],
["Sunset in Elysian Park (360 Video)","IFnPycWTZpA"],
["Griffith Observatory Golden Hour (360 Video)","MiIWPntiG6o"],
["The Lab (360 Video)","yy9kL1UBKrA"],
["Beverly Glenn Bike Ride in LA, CA (360 Video)","Pre0YU_jVZI"],
["Kenter Trailhead in Brentwood, CA (360 Video)","aGCoDEIygV4"],
["The Getty (360 Video)","vQoC8ctqLTo"],
["USC School of Cinematic Arts Courtyard (360 Video)","1XcNCUiiiAU"],
["Trent Peltz - Going To Hell (Live at Molly Malone's) (360 Video)","TTqsjg2kfI0"],
["Trent Peltz - Empty Bottles (Live at Molly Malone's) (360 Video)","Hc4x3pfNxJo"],
["Trent Peltz - Wish I Knew (Live at Molly Malone's) (360 Video)","M9ytKGVAX8g"],
["Trent Peltz - Don't Pull Your Love (Live at Molly Malone's) (360 Video)","Y7E1wy2pFJk"],
["Trent Peltz - Crossing Bridges (Live at Molly Malone's) (360 Video)","2YgumI53dV4"],
["Trent Peltz - Fade Into Nothing (Live at Molly Malone's) (360 Video)","Jin5zaabxW8"],
["Trent Peltz - Why Am I So Different? (Live at Molly Malone's) (360 Video)","2wZieCDd_BU"],
["Trent Peltz - Going to Hell (Live at El Cid 8/16/2023)","mee5oIo-cVk"],
["Trent Peltz - Empty Bottles (Live at El Cid 8/16/2023)","aCVsEkvob3I"],
["The Hackathon (360 Video)","X7Q2lP0TS3I"],
["Luh Kee B - Live at El Cid (8/16/2023)","sCe5o62eo14"],
["Self Transcendence Podcast (Episode 1)","64bz8ptsA58"],
["Fusion Spaces Testimonial","J9268jfwyc8"]]},
"Blythe":{lat:33.62,lng:-114.59,v:[
["Arizona California Border in Blythe, CA (360 Video)","71_Ld65g8tk"]]},
"Compton":{lat:33.90,lng:-118.22,v:[
["Compton City Hall (360 Video)","Y08n5868ke8"]]},
"San Francisco":{lat:37.77,lng:-122.42,v:[
["Childish Gambino - The Worst Guys (Outside Lands 2019) (180 video)","jDCeCWEKJXo"],
["Fort Point in San Francisco (360 Video)","qxkM7KH7Ags"],
["Chinatown San Francisco (360 Video)","qwDcFNBi170"],
["SF Museum of Ice Cream (360 Video)","Af96mQciDXg"],
["Walt Disney Family Museum in SF (360 Video)","CeqFSRdz6zY"],
["Aquatic Park Cove in San Francisco (360 Video)","X0IKCsE3mEw"],
["Saturday in the Bay (360 Video)","25Q4TsPt-JI"],
["Haight-Ashbury San Francisco (360 Video)","teNzMx-K9Ss"],
["Mission Dolores Park San Francisco (360 Video)","DQsCxdxT3AU"],
["The Dogs of San Fransisco - Dolores Park 4/20 (360 Video)","nkZGkwRABgs"],
["Alamo Square Park, San Francisco (360 Video)","J75ZQ0THzZM"],
["Ghirardelli Square in San Francisco (360 Video)","se_xPLCbO3I"],
["Buena Vista Park Summit in SF (360 Video)","OhbulCFPzco"],
["SF Revel Ride with the Strobe (360 Video)","waatRmwmOBQ"],
["View from Twin Peaks in San Francisco (180 Video)","Nf62WxHSLIA"],
["SF Womp Convention (360 Video)","hJd6J4eWGE4"],
["Painted Ladies Womp","qm9uV3uezHY"],
["Meta SF Office 250 Howard (360 Video)","yUlbMYVLCqc"],
["Meta SF Office Views (360 Video)","dK2AS3CMuvQ"]]},
"Kfar Kama":{lat:32.72,lng:35.43,v:[
["Kfar Kama - Circassian Town in Israel (360 Video)","JWq8cb7PJnY"]]},
"Honolulu":{lat:21.31,lng:-157.86,v:[
["Coby in Hawaii (360 Video)","5kxA-SY7cKo"],
["Skating in Waikiki (360 Video)","k11kXAsVQYo"]]},
"Stanford":{lat:37.43,lng:-122.17,v:[
["Stanford University Drone Footage (4k)","hQDEm9wBTG4"],
["Matoma at Stanford KSig (360 Video)","bQCdaPs1BmA"],
["2 Chainz - 4 AM Live at Stanford Blackfest (360 Video)","E5DH9SKqqhc"],
["Oy/Yo Sculpture, Stanford (360 Video)","8jq3HupR_HQ"],
["Stanford University Walk (360 Video)","NKErCz4b_10"],
["Stanford Engineering Quad (360 Video)","uBN8nsCYZCM"],
["Stanford University Quad (360 Video)","Ry79fCAKvwo"],
["Pre-Luau Party Walk Through (360 Video)","GvHeyBLL-3U"]]},
"Palm Springs":{lat:33.83,lng:-116.55,v:[
["Giant Marilyn Monroe Statue in Palm Springs (360 Video)","44MGxjlrC-4"],
["VR Waterslide in Palm Springs (360 Video)","McV_DTwMyeY"],
["Palm Springs Art Museum (360 Video)","FySmghPBGAs"],
["Palm Springs Aerial Tramway Ride Time-lapse (360 Video)","g5CCCtsGW44"],
["Palm Springs Aerial Tramway Summit (360 Video)","icgdeQ27r8w"],
["VR Sledding near Mount San Jacinto (360 Video)","Ss5h5HweKVw"],
["Big Horned Sheep at Lykken Trail Summit Palm Springs (360 Video)","WVFRBdtiFC8"],
["Victor Trail at Indian Canyons in Palm Springs (360 Video)","zKf_ZbW9izs"],
["Andreas Loop Hike at Indian Canyons in Palm Springs (360 Video)","LFFjr8KPk30"]]},
"Century City":{lat:34.06,lng:-118.42,v:[
["Exploring Fox Studios in Century City, CA (360 Video)","CbiwPyejRE4"]]},
"Cordes Lakes":{lat:34.31,lng:-112.10,v:[
["Jim's Weed Farm (360 video)","rYjYwWWbC_E"],
["Cordes Lakes Trip (360 video)","tlXlu4j65b0"],
["Junior the Bird Ribbits like a Frog in Cordes Lakes, AZ (360 Video)","fv8H7lq0yBY"],
["Smoke Sesh with Uncle Marty (360 video)","FTrBVxRZiy0"]]},
"Beaverton":{lat:45.49,lng:-122.80,v:[
["Nike Company Store in Beaverton, OR (360 Video)","TqrNTT8bdBo"],
["Nike Campus Drive Through in Beaverton, OR (360 Video)","4qFQ75uatmk"]]},
"Santa Cruz":{lat:36.97,lng:-122.03,v:[
["Cowell's Beach in Santa Cruz (360 Video)","IVAD9BIkHvI"],
["Hopping in at Steamer Lane Santa Cruz, CA (360 Video)","_yD8Y_6kN5s"]]},
"Scottsdale":{lat:33.49,lng:-111.93,v:[
["Justin Gets MAErried - Kevin and Max's Best Men Speech (360 Video)","ZYmIgtKoYA8"],
["Pinnacle Peak Hike in Scottsdale, AZ (360 Video)","d14wfQHF2_4"]]},
"Redondo Beach":{lat:33.85,lng:-118.39,v:[
["Redondo Beach Volleyball (360 Video)","n_09XSd8UrA"],
["Subterranean Sconch","Tefl8qr54ds"]]},
"Catalina Island":{lat:33.34,lng:-118.33,v:[
["Buena Vista Scenic Overlook on Catalina Island (360 Video)","wGZl_iUjrqk"],
["Catalina Island Airport in the Sky (360 Video)","E0zEtjUxMoI"],
["Catalina Island Snorkeling (360 Video)","7z-z7RQrcl4"],
["Three Palms Scenic Overlook on Catalina Island (360 Video)","fLwbpbUaxO0"],
["Catalina Island Hummer Tour (360 Video)","J20zwAAgFQc"],
["Catalina Express Ride (360 Video)","6UjkzXglLPU"],
["Catalina Island Sightseeing (360 Video)","OEvAh-DR2as"],
["Catalina Island Trip (360 Video)","yBHZHZhPhB0"]]},
"Haifa":{lat:32.79,lng:34.99,v:[
["Bahai Temple in Haifa, Israel (360 Video)","Y2qrPui3NU0"],
["Last Crusader Forts in Israel (360 Video)","JmowhHxoZh0"]]},
"Truckee":{lat:39.33,lng:-120.18,v:[
["Truckee River Rafting Adventure (360 Video)","SsAKFtdXMRI"],
["Truckee River Rapids (360 Video)","LGjCGbHSKWE"]]},
"Coloma":{lat:38.80,lng:-120.89,v:[
["American River White Water Rafting - Satan's Cesspool (360 video)","rADNmSj_4vE"],
["American River White Water Rafting - Scissors (360 video)","8gGeK_aWvwA"],
["American River White Water Rafting - Hospital Bar (360 video)","QLiLSjuMJEE"],
["American River White Water Rafting - Fowler's Rock (360 video)","ZRqOqnIbGGA"],
["American River White Water Rafting - Lower Haystack Rapids (360 video)","naqJTh7O17Q"]]},
"Beverly Hills":{lat:34.07,lng:-118.40,v:[
["Rodeo Drive Walk (360 Video)","hGDml5Sgrj8"],
["Ranch Trail in Beverly Hills (360 Video)","i8RRRRwIadA"]]},
"Anaheim":{lat:33.84,lng:-117.91,v:[
["Cars Land - California Adventure (360 Video)","ESxM1R2qqsc"],
["Rise of the Resistance - Disneyland (360 Video)","WPcynYkldpw"],
["Guardians of the Galaxy Tower of Terror - California Adventure (360 Video)","F6-5f0HR8-g"],
["Incredicoaster - California Adventure (360 Video)","3knXwIcsUCw"],
["Disneyland, CA (360 Video)","Yl6hdjpxPU8"]]},
"Cochi":{lat:9.93,lng:76.27,v:[
["Visiting the Jewish Synagogues of Kerala","UzfAocycsVY"]]},
"Red Rock Canyon":{lat:35.37,lng:-117.99,v:[
["Red Rock Canyon State Park 'Cave' Exploration (360 Video)","bJGt_T3q9GI"],
["Red Rock Canyon State Park, CA (360 Video)","rKbSARsxsDo"]]},
"Dana Point":{lat:33.47,lng:-117.70,v:[
["Jacuzzi Cannonball in Dana Point (360 Video)","hDP4I5J-uEY"]]},
"Bodie":{lat:38.21,lng:-119.01,v:[
["Bodie, CA: A Ghost Town (360 Video)","gjXmnqJkhWE"],
["Bodie, CA (360 Video)","oNsbzwfST6Y"]]},
"Pacifica":{lat:37.61,lng:-122.49,v:[
["Surfing Pacifica (360 Video)","4DPnO9segr4"],
["Womping and Surfing (360 Video)","jFLbep-CfKA"]]},
"Hollywood":{lat:34.09,lng:-118.33,v:[
["El Capitan Theater in Hollywood, CA (360 Video)","gqPpjYSetdw"],
["TCL Chinese Theater in Hollywood, CA (360 Video)","RRgA88T47MQ"]]},
"Venice":{lat:34.00,lng:-118.46,v:[
["Hotel Erwin Rooftop in Venice, CA (360 Video)","lKz4Ep3fSD8"],
["Mocap Capture Day in Venice (360 Video)","comTWxVQbxM"],
["Abbot Kinney Blvd in Venice (360 Video)","9TEMGYzpEnU"],
["Rosh Hashana in Venice","Hmvg8H__n18"]]},
"Phoenix":{lat:33.45,lng:-112.07,v:[
["My Childhood Home (360 Video)","0ku_Bs785ng"],
["Just Gets MAErried - Justin's Entrance (360 Video)","5BwwkbVdA6k"],
["Electro-Symbio Phonics for Phoenix by Nam June Paik (360 Video)","okUZHEKmSXE"],
["Justin Gets MAErried - Justin and Mae's First Dance","tnKxaXhqt4o"],
["Sky Train in Phoenix, AZ (360 Video)","uZUA8awnvcI"],
["Glassmaking Lesson from Spencer (360 Video)","OEC830NnzJI"],
["Spencer Makes a Glass Heart (360 Video)","vs-hht09AeY"],
["Wrigley Mansion View in Phoenix, AZ (360 Video)","tbJBHnhrY6U"],
["Tanner and Lexi's Wedding in Phoenix, AZ (360 Video)","As5zFVCWqow"]]},
"Encino":{lat:34.15,lng:-118.52,v:[
["Mercedes Benz of Encino AMG Showroom (360 Video)","KRwQp2O7u5E"]]},
"Palo Alto":{lat:37.44,lng:-122.14,v:[
["500 Waves (360 Video)","xw5rN3_URlI"]]},
"Tel Aviv":{lat:31.77,lng:34.79,v:[
["Azareli Sarona Tower in Tel Aviv, Israel (360 Video)","sFX4cDOTuDY"],
["Rothschild Avenue in Israel (360 Video)","a5JE-agiyT8"],
["Meta Rothschild Office in Israel (360 Video)","7tq5ysgvRaI"]]},
"Las Catalinas":{lat:10.58,lng:-85.79,v:[
["Scuba Diving at Las Catalinas Islands, Costa Rica (360 Video)","yLrnmHXeqBY"],
["Exploring Las Catalinas, Costa Rica (360 Video)","w_U-rxT_Ir0"]]},
"Portland":{lat:45.52,lng:-122.68,v:[
["VR Zen Garden Meditation Experience","l_cgTqovxBo"],
["Portland Japanese Garden Koi Pond (360 Video)","MYa17R0yfMk"],
["Portland Japanese Garden (360 Video)","Qt6iETCnm00"],
["Burnside Bridge Scooter Ride in Portland, OR (360 Video)","551UpxhRcNA"],
["Broadway Bridge Scooter Ride in Portland, OR (360 Video)","1Du-xgl_eMM"],
["Battleship Oregon Memorial Marine Park Scooter Ride in Portland, OR (360 Video)","9fYFhEEbFdU"],
["Washington Park Rose Garden (360 Video)","ZefC7pSFkfE"]]},
"Pacific Palisades":{lat:34.04,lng:-118.52,v:[
["Palisades Fire Aftermath (360 Video)","PiG9ZOX8KRg"],
["Inspiration Point at Will Rogers State Park (360 Video)","aFPUUyOvO68"],
["Temescal Canyon Trail Summit - Pacific Palisades (360 Video)","rP4-2OJ2jH8"]]},
"La Jolla":{lat:32.83,lng:-117.27,v:[
["La Jolla Night Swimming (360 Video)","yPZNap75I0w"]]},
"Lee Vining":{lat:37.96,lng:-119.12,v:[
["Mono Lake (360 Video)","C-QatHxx8tk"]]},
"Marina Del Rey":{lat:33.98,lng:-118.45,v:[
["Ballona Creek in Marina Del Rey, CA (360 video)","Cr2597o6uQY"]]},
"Culver City":{lat:33.99,lng:-118.40,v:[
["July 4th Fireworks (360 video)","V_cmfZko3NE"],
["Culver Steps in Culver City, CA (360 Video)","nEWvh-2WlQw"]]},
"Cabazon":{lat:33.92,lng:-116.79,v:[
["Mt. San Jacinto view from Cabazon, CA (360 Video)","WeH1jOVgRM0"]]},
"Joshua Tree":{lat:34.13,lng:-116.31,v:[
["Sunset at Joshua Tree National Park (360 Video)","8MNwqH3xXBE"],
["Arch Rock Nature Trail in Joshua Tree (360 Video)","76PLUMURPHI"],
["Cholla Fields at Joshua Tree (360 Video)","209p-U0rvHM"],
["Joshua Tree South Entrance (360 Video)","f8G_f-b1tx4"],
["Big Joshua Tree LOOK UP (360 Video)","MHpCZfrcfck"],
["Keys View at Joshua Tree National Park (360 Video)","d78WGvcRq8E"],
["Skull Rock Nature Trail in Joshua Tree (360 Video)","1iKk7oBq1zE"],
["Joshua Tree Trip (Part 1) (360 Video)","eG3Mr5G2Zo0"],
["Joshua Tree Trip (Part 2) (360 Video)","ERsxpJyZIsk"]]},
"Government Camp":{lat:45.30,lng:-121.75,v:[
["Coby and Eric go to Timberline Hotel, Talk Quantum (360 Video)","qfyJDjh8UuA"],
["VR Mountain Biking #4 (360 Video)","uymeDoS2gqM"],
["Downhill Bike Ride at Timberline Lodge (360 Video)","WQ9dQbxzZhw"],
["Timberline Lodge Hotel in Government Camp, OR (360 Video)","7RPmG6oCp2E"],
["VR Mountain Biking #1 (360 Video)","7OAfjHboYeQ"],
["VR Mountain Biking #2 (360 Video)","HIFwKgsQNFo"],
["VR Mountain Biking #3 (360 Video)","ZisFZfnjm7U"],
["Timberline Lodge Ski Lift (360 Video)","ijCSgMZOA_8"]]},
"Re'im":{lat:31.38,lng:34.46,v:[
["Nova Music Festival Aftermath in Israel (360 Video)","GwAi5TUOVrU"],
["October 7th Aftermath in Israel (360 Video)","kbe3LPYOo5g"]]},
"Menlo Park":{lat:37.45,lng:-122.18,v:[
["Skateboarding at Menlo Skatepark (360 Video)","u24FG8W2Kh8"]]},
"Jerusalem":{lat:31.77,lng:35.21,v:[
["Jerusalem (360 Video)","uBB3H7MxCkw"]]},
"San Jose":{lat:37.34,lng:-121.89,v:[
["Cinequest Film and VR Festival (360 Video)","166liIG19lA"]]},
"Bombay Beach":{lat:33.35,lng:-115.73,v:[
["Salton Sea and Bombay Beach (360 Video)","T7AzGytx75E"]]},
"Independence":{lat:36.81,lng:-118.20,v:[
["Manzanar National Historic Site (360 Video)","uiTIAh-WFrc"]]},
"Milwaukee":{lat:43.04,lng:-87.91,v:[
["McKinley Park in Milwaukee (360 Video)","V1lpJQ7MWGw"],
["Milwaukee Art Museum (360 Video)","GuDPyiB5iGc"],
["Veteran's Park in Milwaukee (360 Video)","OcqOvWxaap0"],
["Milwaukee River (360 Video)","WOEnmz1EKMI"],
["Milwaukee Scooter Ride (360 Video)","0pZbfkceKkI"],
["POG and Jenn Get Married (360 Video)","zbNMnTdoUj8"]]},
"La Fortuna":{lat:10.47,lng:-84.64,v:[
["La Fortuna Waterfall in Costa Rica (360 Video)","qhz4nLR4RcE"]]},
"Tiberias":{lat:32.79,lng:35.53,v:[
["Sea of Galilee in Israel (360 Video)","CYbN_mtyNME"]]},
"Paradise Valley":{lat:33.53,lng:-111.94,v:[
["Casita Teeta Hang in Paradise Valley, AZ (360 Video)","7UySYuxVmyw"]]},
"Palm Desert":{lat:33.72,lng:-116.37,v:[
["Ladder Canyon in the Palm Desert (360 Video)","6EX12891cU4"]]},
"San Marino":{lat:34.12,lng:-118.11,v:[
["The Huntington Library and Museum (360 Video)","maSlcDd2sRw"],
["The Huntington Gardens (360 Video)","e2_nu8JKegg"]]},
"Woodside":{lat:37.43,lng:-122.25,v:[
["Thornewood Open Space Preserve (360 Video)","-wry3t7mUcw"]]},
"Herzliya":{lat:32.16,lng:34.79,v:[
["Downtown Herzliya, Israel (360 Video)","oEG_KFMnFSk"]]},
"Fallen Leaf Lake":{lat:38.91,lng:-120.06,v:[
["Danica Shreds (360 Video)","XGl4Esyc5nY"]]},
"Sacramento":{lat:38.58,lng:-121.49,v:[
["Sacramento Capital and Old Town Sac (360 Video)","ZvK3FLYeP98"]]},
"Caesarea":{lat:32.50,lng:34.89,v:[
["Caesarea Tour in Israel (360 Video)","il9-xYbsnL8"]]},
"Tamarindo":{lat:10.30,lng:-85.84,v:[
["Storm Surfing in Tamarindo, Costa Rica (360 Video)","OB8daFgteds"],
["Bali Go Boat Ride in Costa Rica (360 Video)","bm6eb7utqOc"],
["Sunset Surf Sesh in Tamarindo, Costa Rica (360 Video)","YmuqW56GE1I"]]},
"Pasadena":{lat:34.15,lng:-118.14,v:[
["The Original Trader Joe's (360 Video)","nlCoThD9jrc"]]},
"Sedona":{lat:34.87,lng:-111.76,v:[
["Family Trip to Sedona, AZ (360 Video)","KSKcr5gs8y8"],
["Bell Rock Summit - Sedona, AZ (360 Video)","Sfqf1F8emKo"]]},
"Indio":{lat:33.72,lng:-116.22,v:[
["Coachella (360 Video)","82EXv8fob2A"]]},
"Touws River":{lat:-33.35,lng:20.02,v:[
["Aquila Private Game Reserve, South Africa (360 Video)","adD0ExISbjU"]]},
"Cape Town":{lat:-33.92,lng:18.42,v:[
["Cape of Good Hope, South Africa (360 Video)","pNszrqCxKr4"],
["Table Mountain - Cape Town, South Africa (360 Video)","0AeXH40NZqo"],
["Lion's Head - Cape Town, South Africa (360 Video)","6n2dk4mMZB4"]]},
"Boston":{lat:42.36,lng:-71.06,v:[
["Boston, MA (360 Video)","HM67RqEw-rI"]]},
"Santa Barbara":{lat:34.42,lng:-119.70,v:[
["Santa Barbara County Wine Tour for Jack (360 Video)","Luh1vO1VGyU"]]},
"North Shore":{lat:42.52,lng:-70.89,v:[
["North Shore, MA (360 Video)","aifoFbCmmEk"]]},
"Verde Valley":{lat:34.57,lng:-111.86,v:[
["Verde Valley River - Arizona (360 Video)","tPhECh8cdS8"]]},
"False Bay":{lat:-34.18,lng:18.48,v:[
["Shark Diving in False Bay, South Africa (360 Video)","6DKab2RKxcg"]]},
"Simon's Town":{lat:-34.19,lng:18.43,v:[
["Boulders Beach Penguins, South Africa (360 Video)","F5Aj3IUbB_8"]]},
"Mount Tabor":{lat:32.69,lng:35.39,v:[
["Mount Tabor in Israel (360 Video)","43ajHCW28YI"]]},
"San Diego":{lat:32.72,lng:-117.16,v:[
["Blacks and Torey Pines State Beach (360 Video)","J5w9kJIB_Q0"]]},
"St. Francis Bay":{lat:-34.17,lng:24.84,v:[
["Bruce's Beauties - St. Francis Bay, South Africa (360 Video)","KvBkJ2DG2Z8"]]},
"Salem":{lat:42.52,lng:-70.90,v:[
["Salem, MA (360 Video)","jzxKTft-VUs"]]},
"Prescott":{lat:34.54,lng:-112.47,v:[
["Embry Riddle Aeronautical University in Prescott, AZ (360 Video)","Ux9n3N4W54E"],
["Watson Lake in Prescott, AZ (360 Video)","wdjG7TThxdg"]]},
"Lake Tahoe":{lat:39.10,lng:-120.03,v:[
["Lake Tahoe, CA - Nov 2025 (360 Video)","G6gCbplktW4"]]},
"Arenal":{lat:10.46,lng:-84.68,v:[
["Tabacon Hot Springs in Arenal, Costa Rica (360 Video)","U5w9sagUXMA"],
["Jet Skiing at Lake Arenal in Costa Rica (360 Video)","gDAbguHlSZY"],
["Wild Sloth in Arenal, Costa Rica (360 Video)","6sM6nMVPXmM"],
["Arenal 1968 Park in Costa Rica (360 Video)","LSVEfE_bjFw"]]},
"Monteverde":{lat:10.31,lng:-84.83,v:[
["Tarzan Swing at Selvatura Park in Monteverde, Costa Rica (360 Video)","3ia_WPL6My8"],
["Finca Camino Nuevo in Monteverde, Costa Rica (360 Video)","_CGMCaBXM7g"],
["Hanging Bridges at Selvatura Park in Monteverde, Costa Rica (360 Video)","Atkfys_YiEg"],
["Ziplining at Selvetura Park in Monteverde, Costa Rica (360 Video)","l9ugpPmYRRs"],
["Monteverde Cloud Forest in Costa Rica (360 Video)","SZrupLUjEJs"]]},
"Playa Grande":{lat:10.33,lng:-85.85,v:[
["Surfing in Playa Grande, Costa Rica (360 Video)","4RDoGOFkc44"]]},
"Austin":{lat:30.27,lng:-97.74,v:[
["Austin, TX - Nov 2025 (360 Video)","dS1DiZoklBc"]]},
"Miami":{lat:25.76,lng:-80.19,v:[
["Miami, FL - Nov 2025 (360 Video)","P_JY8UzIY2s"]]},
"Malibu":{lat:34.03,lng:-118.78,v:[
["PCH Fire Aftermath (360 Video)","C8Wt4BcZ-BE"],
["Point Dume in Malibu (360 Video)","_wMxkIVlTwM"],
["Malibu Frisbee Sesh (360 Video)","A4heqhkd4F0"],
["Throwing a Rock at a Dead Seal in Malibu (360 Video)","PpQ-fzbuzX8"]]},
"Mount San Jacinto":{lat:33.81,lng:-116.68,v:[
["Mount San Jacinto (360 Video)","Vq0wdzGrZLM"]]},
"Cape St Francis":{lat:-34.20,lng:24.83,v:[
["Cape St Francis, South Africa (360 Video)","F9vVfNGkYM4"]]},
"Burlingame":{lat:37.58,lng:-122.35,v:[
["Meta Burlingame Office Views (360 Video)","Xjp4Qc55vfk"]]},
"Las Gaviotas":{lat:32.25,lng:-116.98,v:[
["Las Gaviotas, Mexico (360 Video)","zVLRIPWa_pM"]]},
};

// ── Three.js Globe Setup ───────────────────────────────────────────
const container = document.getElementById('globe-container');
const tooltip = document.getElementById('city-tooltip');
const scene = new THREE.Scene();
const camera = new THREE.PerspectiveCamera(45, container.clientWidth / container.clientHeight, 0.1, 1000);
camera.position.set(0, 2, 18);

const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
renderer.setSize(container.clientWidth, container.clientHeight);
renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
container.appendChild(renderer.domElement);

// Controls
const controls = new OrbitControls(camera, renderer.domElement);
controls.enableDamping = true;
controls.dampingFactor = 0.06;
controls.rotateSpeed = 0.5;
controls.minDistance = 5.5;
controls.maxDistance = 30;
const AUTO_ROTATE_THRESHOLD = 17; // only auto-rotate when zoomed out past this distance
controls.enablePan = false;
controls.autoRotate = true;
controls.autoRotateSpeed = 0.4;

// Lights
scene.add(new THREE.AmbientLight(0x555570, 1.5));
const sunLight = new THREE.DirectionalLight(0xfff0dd, 1.0);
sunLight.position.set(5, 3, 5);
scene.add(sunLight);

// Globe sphere
const GLOBE_RADIUS = 5;
const textureLoader = new THREE.TextureLoader();
const earthTexture = textureLoader.load('https://unpkg.com/three-globe@2.31.0/example/img/earth-night.jpg');
const globeGeom = new THREE.SphereGeometry(GLOBE_RADIUS, 64, 64);
const globeMat = new THREE.MeshStandardMaterial({
    map: earthTexture,
    roughness: 0.9,
    metalness: 0.1,
});
const globe = new THREE.Mesh(globeGeom, globeMat);
scene.add(globe);

// Atmosphere glow
const atmosGeom = new THREE.SphereGeometry(GLOBE_RADIUS * 1.015, 64, 64);
const atmosMat = new THREE.ShaderMaterial({
    vertexShader: `
        varying vec3 vNormal;
        void main(){
            vNormal = normalize(normalMatrix * normal);
            gl_Position = projectionMatrix * modelViewMatrix * vec4(position,1.0);
        }
    `,
    fragmentShader: `
        varying vec3 vNormal;
        void main(){
            float intensity = pow(0.65 - dot(vNormal, vec3(0.0, 0.0, 1.0)), 3.0);
            gl_FragColor = vec4(0.3, 0.6, 1.0, 1.0) * intensity * 0.8;
        }
    `,
    blending: THREE.AdditiveBlending,
    side: THREE.BackSide,
    transparent: true
});
scene.add(new THREE.Mesh(atmosGeom, atmosMat));

// Stars background
const starGeom = new THREE.BufferGeometry();
const starVerts = [];
for (let i = 0; i < 3000; i++) {
    const r = 80 + Math.random() * 120;
    const theta = Math.random() * Math.PI * 2;
    const phi = Math.acos(2 * Math.random() - 1);
    starVerts.push(r * Math.sin(phi) * Math.cos(theta), r * Math.cos(phi), r * Math.sin(phi) * Math.sin(theta));
}
starGeom.setAttribute('position', new THREE.Float32BufferAttribute(starVerts, 3));
scene.add(new THREE.Points(starGeom, new THREE.PointsMaterial({ color: 0xffffff, size: 0.15 })));

// ── Pin Creation ───────────────────────────────────────────────────
function latLngToVec3(lat, lng, radius) {
    const phi = (90 - lat) * (Math.PI / 180);
    const theta = (lng + 180) * (Math.PI / 180);
    return new THREE.Vector3(
        -radius * Math.sin(phi) * Math.cos(theta),
        radius * Math.cos(phi),
        radius * Math.sin(phi) * Math.sin(theta)
    );
}

const pinGroup = new THREE.Group();
scene.add(pinGroup);
const pinObjs = []; // {mesh, city, ringMesh}

// Create glow texture for rings
function makeRingTexture() {
    const c = document.createElement('canvas');
    c.width = 64; c.height = 64;
    const ctx = c.getContext('2d');
    const grad = ctx.createRadialGradient(32, 32, 0, 32, 32, 32);
    grad.addColorStop(0, 'rgba(255,80,40,0.9)');
    grad.addColorStop(0.4, 'rgba(255,40,20,0.4)');
    grad.addColorStop(1, 'rgba(255,0,0,0)');
    ctx.fillStyle = grad;
    ctx.fillRect(0, 0, 64, 64);
    return new THREE.CanvasTexture(c);
}
const glowTex = makeRingTexture();

const pinMat = new THREE.MeshBasicMaterial({ color: 0xff4444 });
const pinGeom = new THREE.SphereGeometry(0.06, 12, 12);

Object.entries(CITIES).forEach(([city, data]) => {
    const pos = latLngToVec3(data.lat, data.lng, GLOBE_RADIUS + 0.03);
    // Pin dot
    const pin = new THREE.Mesh(pinGeom, pinMat.clone());
    pin.position.copy(pos);
    pin.userData = { city };
    pinGroup.add(pin);

    // Glow ring (sprite)
    const sprite = new THREE.Sprite(new THREE.SpriteMaterial({
        map: glowTex, transparent: true, opacity: 0.6, depthWrite: false
    }));
    sprite.position.copy(pos);
    sprite.scale.set(0.5, 0.5, 1);
    pinGroup.add(sprite);

    pinObjs.push({ mesh: pin, sprite, city, pos });
});

// ── Raycasting & Interaction ───────────────────────────────────────
const raycaster = new THREE.Raycaster();
const mouse = new THREE.Vector2();
let hoveredPin = null;
let pinScale = 1; // updated each frame based on camera distance

function onPointerMove(e) {
    const rect = renderer.domElement.getBoundingClientRect();
    mouse.x = ((e.clientX - rect.left) / rect.width) * 2 - 1;
    mouse.y = -((e.clientY - rect.top) / rect.height) * 2 + 1;
}
renderer.domElement.addEventListener('pointermove', onPointerMove);

function onPointerDown(e) {
    const rect = renderer.domElement.getBoundingClientRect();
    mouse.x = ((e.clientX - rect.left) / rect.width) * 2 - 1;
    mouse.y = -((e.clientY - rect.top) / rect.height) * 2 + 1;
    raycaster.setFromCamera(mouse, camera);
    const pins = pinObjs.map(p => p.mesh);
    const hits = raycaster.intersectObjects(pins);
    if (hits.length > 0) {
        const city = hits[0].object.userData.city;
        openPanel(city);
        // Rotate globe to face this city
        const data = CITIES[city];
        const target = latLngToVec3(data.lat, data.lng, GLOBE_RADIUS + 5);
        // autoRotate is handled by zoom distance in the animate loop
    }
}
renderer.domElement.addEventListener('pointerdown', onPointerDown);

// Tooltip
function updateTooltip() {
    raycaster.setFromCamera(mouse, camera);
    const pins = pinObjs.map(p => p.mesh);
    const hits = raycaster.intersectObjects(pins);

    if (hits.length > 0) {
        const city = hits[0].object.userData.city;
        const data = CITIES[city];
        if (hoveredPin !== city) {
            hoveredPin = city;
            tooltip.innerHTML = city + '<span class="video-count">' + data.v.length + ' video' + (data.v.length !== 1 ? 's' : '') + '</span>';
            tooltip.style.display = 'block';
            pinObjs.forEach(p => {
                p.sprite.material.opacity = p.city === city ? 1.0 : 0.6;
            });
        }
        // Project pin position to screen
        const pos = hits[0].object.position.clone().project(camera);
        const rect = renderer.domElement.getBoundingClientRect();
        tooltip.style.left = ((pos.x + 1) / 2 * rect.width) + 'px';
        tooltip.style.top = ((-pos.y + 1) / 2 * rect.height) + 'px';
        renderer.domElement.style.cursor = 'pointer';
    } else {
        if (hoveredPin) {
            hoveredPin = null;
            tooltip.style.display = 'none';
            pinObjs.forEach(p => {
                p.sprite.material.opacity = 0.6;
            });
            renderer.domElement.style.cursor = 'grab';
        }
    }
}

// ── Video Panel ────────────────────────────────────────────────────
const panel = document.getElementById('video-panel');
const overlay = document.getElementById('panel-overlay');

function openPanel(city) {
    const data = CITIES[city];
    document.getElementById('panel-city-name').textContent = city;
    document.getElementById('panel-city-count').textContent = data.v.length + ' video' + (data.v.length !== 1 ? 's' : '');
    const list = document.getElementById('panel-video-list');
    list.innerHTML = data.v.map(([title, id]) => `
        <div class="video-item" data-id="${id}">
            <div class="video-thumb">
                <img src="https://img.youtube.com/vi/${id}/mqdefault.jpg" alt="${title}" loading="lazy">
                <div class="play-icon"><svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg></div>
            </div>
            <div class="video-item-info">
                <div class="video-item-title">${title}</div>
            </div>
        </div>
    `).join('');
    // Click handlers
    list.querySelectorAll('.video-item').forEach(item => {
        item.addEventListener('click', () => openVideoModal(item.dataset.id));
    });
    panel.classList.add('active');
    overlay.classList.add('active');
}

function closePanel() {
    panel.classList.remove('active');
    overlay.classList.remove('active');
}

document.getElementById('panel-close').addEventListener('click', closePanel);
overlay.addEventListener('click', closePanel);

// ── Video Modal ────────────────────────────────────────────────────
function openVideoModal(videoId) {
    const modal = document.getElementById('video-modal');
    document.getElementById('video-iframe').src = 'https://www.youtube.com/embed/' + videoId + '?autoplay=1';
    modal.classList.add('active');
    document.body.style.overflow = 'hidden';
}
function closeVideoModal() {
    const modal = document.getElementById('video-modal');
    document.getElementById('video-iframe').src = '';
    modal.classList.remove('active');
    document.body.style.overflow = '';
}
document.getElementById('modal-close').addEventListener('click', closeVideoModal);
document.getElementById('video-modal').addEventListener('click', (e) => {
    if (e.target === e.currentTarget) closeVideoModal();
});
document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') { closeVideoModal(); closePanel(); }
});

// ── Animate ────────────────────────────────────────────────────────
function animate() {
    requestAnimationFrame(animate);
    // Auto-rotate only when fully zoomed out
    const camDist = camera.position.length();
    controls.autoRotate = camDist >= AUTO_ROTATE_THRESHOLD;
    controls.update();
    // Scale pins based on zoom distance
    pinScale = camDist / 18;
    const t = Date.now() * 0.003;
    pinObjs.forEach((p, i) => {
        const base = p.city === hoveredPin ? 2.2 * pinScale : pinScale;
        p.mesh.scale.setScalar(base);
        const s = (0.4 + Math.sin(t + i * 0.3) * 0.1) * pinScale;
        if (p.city !== hoveredPin) p.sprite.scale.set(s, s, 1);
        else p.sprite.scale.set(0.5 * pinScale, 0.5 * pinScale, 1);
    });
    updateTooltip();
    renderer.render(scene, camera);
}
animate();

// Resize
window.addEventListener('resize', () => {
    const w = container.clientWidth, h = container.clientHeight;
    camera.aspect = w / h;
    camera.updateProjectionMatrix();
    renderer.setSize(w, h);
});

// ── 3D Social Icons (kept from original) ───────────────────────────
const socialIcons = document.querySelectorAll('.social-icon-container');
const socialScenes = [];
socialIcons.forEach((iconContainer) => {
    const modelPath = iconContainer.dataset.model;
    const link = iconContainer.dataset.link;
    const iconScene = new THREE.Scene();
    const iconCamera = new THREE.PerspectiveCamera(50, 1, 0.1, 1000);
    const iconRenderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
    iconRenderer.setSize(100, 100);
    iconRenderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
    iconContainer.appendChild(iconRenderer.domElement);
    iconCamera.position.set(0, 0, 3);
    iconScene.add(new THREE.AmbientLight(0xffffff, 0.8));
    const iconKey = new THREE.DirectionalLight(0xffffff, 1.2);
    iconKey.position.set(2, 2, 2);
    iconScene.add(iconKey);
    const iconLoader = new GLTFLoader();
    iconLoader.load(modelPath, (gltf) => {
        const m = gltf.scene;
        const box = new THREE.Box3().setFromObject(m);
        const size = box.getSize(new THREE.Vector3());
        m.scale.setScalar(1.8 / Math.max(size.x, size.y, size.z));
        const sBox = new THREE.Box3().setFromObject(m);
        const c = sBox.getCenter(new THREE.Vector3());
        m.position.set(-c.x, -c.y, -c.z);
        const pivot = new THREE.Group();
        pivot.add(m);
        iconScene.add(pivot);
        iconContainer._pivot = pivot;
        iconContainer._manualRotation = 0;
        iconContainer._isDragging = false;
        iconContainer._hasDragged = false;
        iconContainer._lastX = 0;
    });
    socialScenes.push({ scene: iconScene, camera: iconCamera, renderer: iconRenderer });
    const onDragStart = (cx) => { iconContainer._isDragging = true; iconContainer._hasDragged = false; iconContainer._lastX = cx; };
    const onDragMove = (cx) => {
        if (iconContainer._isDragging && iconContainer._pivot) {
            const d = cx - iconContainer._lastX;
            if (Math.abs(d) > 2) iconContainer._hasDragged = true;
            iconContainer._manualRotation += d * 0.02;
            iconContainer._lastX = cx;
        }
    };
    const onDragEnd = () => { iconContainer._isDragging = false; };
    iconContainer.addEventListener('mousedown', (e) => { e.preventDefault(); onDragStart(e.clientX); });
    window.addEventListener('mousemove', (e) => { onDragMove(e.clientX); });
    window.addEventListener('mouseup', onDragEnd);
    iconContainer.addEventListener('touchstart', (e) => { onDragStart(e.touches[0].clientX); }, { passive: true });
    window.addEventListener('touchmove', (e) => { if (iconContainer._isDragging) onDragMove(e.touches[0].clientX); }, { passive: true });
    window.addEventListener('touchend', onDragEnd);
    iconContainer.addEventListener('click', () => { if (!iconContainer._hasDragged) window.open(link, '_blank'); });
});
function animateSocialIcons() {
    requestAnimationFrame(animateSocialIcons);
    const time = Date.now() * 0.001;
    socialIcons.forEach((ic, i) => {
        const p = ic._pivot;
        if (p) {
            if (ic._isDragging) { p.rotation.y = ic._manualRotation; }
            else { const a = time + i * 0.5; ic._manualRotation = a; p.rotation.y = a; }
        }
    });
    socialScenes.forEach((item) => { item.renderer.render(item.scene, item.camera); });
}
animateSocialIcons();
    </script>
</body>
</html>
